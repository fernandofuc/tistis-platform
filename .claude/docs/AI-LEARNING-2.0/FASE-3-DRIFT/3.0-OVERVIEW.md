# ğŸ“‰ FASE 3: Drift Detection

## Sistema de DetecciÃ³n de DegradaciÃ³n del Modelo

**Documento:** 3.0-OVERVIEW.md
**Fase:** 3 - Drift Detection
**DuraciÃ³n estimada:** 6-7 semanas
**Costo adicional:** ~$0/mes (usa infraestructura existente)

---

## ğŸ“‹ Ãndice

1. [Objetivo](#objetivo)
2. [Tipos de Drift](#tipos-de-drift)
3. [Arquitectura](#arquitectura)
4. [Microfases](#microfases)
5. [ImplementaciÃ³n de Alto Nivel](#implementaciÃ³n-de-alto-nivel)
6. [Alertas y Monitoreo](#alertas-y-monitoreo)
7. [Checklist General](#checklist-general)

---

## ğŸ¯ Objetivo

Implementar un sistema de detecciÃ³n automÃ¡tica de degradaciÃ³n (drift) del modelo de AI para alertar cuando el sistema necesita reentrenamiento o ajustes.

### Â¿Por quÃ© es necesario?

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DRIFT PROBLEM                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Time = 0 (Model deployed)                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Training Data Distribution                              â”‚   â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                               â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚  Production Data Distribution                            â”‚   â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  (match!)                     â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚  Model Performance: 95% accuracy âœ…                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  Time = 6 months (Data drift occurs)                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Training Data Distribution                              â”‚   â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                               â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚  Production Data Distribution                            â”‚   â”‚
â”‚  â”‚          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  (shifted!)       â”‚   â”‚
â”‚  â”‚                                                          â”‚   â”‚
â”‚  â”‚  Model Performance: 72% accuracy âŒ                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  Without drift detection: Silent degradation                     â”‚
â”‚  With drift detection: Alert in <24 hours ğŸ””                    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Tipos de Drift

### 1. Data Drift (Covariate Shift)

La distribuciÃ³n de los datos de entrada cambia.

```typescript
// Ejemplo: Cambio en el vocabulario de usuarios
interface DataDrift {
  type: 'data_drift';

  // Metrics
  embedding_centroid_shift: number;  // Cambio en centroide de embeddings
  vocabulary_overlap: number;         // % vocabulario conocido
  message_length_distribution: {
    mean_shift: number;
    variance_change: number;
  };

  // Threshold
  threshold: 0.15;  // >15% shift triggers alert
}
```

### 2. Concept Drift

La relaciÃ³n entre input y output cambia.

```typescript
// Ejemplo: "reserva" antes significaba citas, ahora significa mesas
interface ConceptDrift {
  type: 'concept_drift';

  // Metrics
  intent_distribution_change: number;
  classification_confidence_drop: number;
  user_correction_rate: number;  // From RLHF

  // Threshold
  threshold: 0.10;  // >10% change triggers alert
}
```

### 3. Performance Drift

Las mÃ©tricas de performance degradan sin cambio aparente en datos.

```typescript
interface PerformanceDrift {
  type: 'performance_drift';

  // Metrics
  satisfaction_rate_change: number;  // From RLHF
  response_time_change: number;
  error_rate_change: number;

  // Threshold
  threshold: 0.05;  // >5% degradation triggers alert
}
```

---

## ğŸ—ï¸ Arquitectura

### Componentes del Sistema

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DRIFT DETECTION ARCHITECTURE                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                     â”‚
â”‚  [Production Data]                                                 â”‚
â”‚         â”‚                                                           â”‚
â”‚         â–¼                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚
â”‚  â”‚  Metrics Collectorâ”‚  (continuous)                               â”‚
â”‚  â”‚  - Embedding statsâ”‚                                             â”‚
â”‚  â”‚  - Performance    â”‚                                             â”‚
â”‚  â”‚  - User feedback  â”‚                                             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â”‚            â”‚                                                        â”‚
â”‚            â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚  Reference        â”‚     â”‚  Current Window   â”‚                  â”‚
â”‚  â”‚  Distribution     â”‚â—„â”€â”€â”€â–ºâ”‚  Distribution     â”‚                  â”‚
â”‚  â”‚  (baseline)       â”‚     â”‚  (last 24h-7d)    â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚            â”‚                         â”‚                              â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                       â”‚                                             â”‚
â”‚                       â–¼                                             â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚            â”‚  Statistical Testsâ”‚                                   â”‚
â”‚            â”‚  - KS Test        â”‚                                   â”‚
â”‚            â”‚  - Chi-Square     â”‚                                   â”‚
â”‚            â”‚  - PSI            â”‚                                   â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â”‚
â”‚                      â”‚                                              â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                   â”‚
â”‚            â”‚                   â”‚                                    â”‚
â”‚            â–¼                   â–¼                                    â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚     â”‚ No Drift â”‚        â”‚ Drift    â”‚                              â”‚
â”‚     â”‚ Detected â”‚        â”‚ Detected â”‚                              â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                              â”‚                                      â”‚
â”‚                              â–¼                                      â”‚
â”‚                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚                       â”‚    Alerting   â”‚                            â”‚
â”‚                       â”‚  - Slack      â”‚                            â”‚
â”‚                       â”‚  - Email      â”‚                            â”‚
â”‚                       â”‚  - Dashboard  â”‚                            â”‚
â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Estructura de Archivos

```
src/features/ai/drift/
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ metrics-collector.service.ts    # RecolecciÃ³n de mÃ©tricas
â”‚   â”œâ”€â”€ drift-detector.service.ts       # DetecciÃ³n de drift
â”‚   â”œâ”€â”€ alerting.service.ts             # Sistema de alertas
â”‚   â””â”€â”€ reference-manager.service.ts    # GestiÃ³n de baselines
â”œâ”€â”€ statistics/
â”‚   â”œâ”€â”€ ks-test.ts                      # Kolmogorov-Smirnov test
â”‚   â”œâ”€â”€ chi-square.ts                   # Chi-square test
â”‚   â”œâ”€â”€ psi.ts                          # Population Stability Index
â”‚   â””â”€â”€ statistical-utils.ts            # Utilidades
â”œâ”€â”€ types/
â”‚   â””â”€â”€ drift.types.ts                  # Tipos
â””â”€â”€ jobs/
    â””â”€â”€ drift-detection-cron.ts         # Cron job
```

---

## ğŸ“¦ Microfases

### 3.1 Metrics Collector (2 semanas)

```
Objetivo: Recolectar y almacenar mÃ©tricas para anÃ¡lisis de drift

Entregables:
â”œâ”€â”€ MetricsCollectorService
â”œâ”€â”€ Tabla ai_drift_metrics en Supabase
â”œâ”€â”€ Embedding statistics calculator
â”œâ”€â”€ Performance metrics aggregator
â””â”€â”€ RLHF metrics integration

MÃ©tricas a recolectar:
â”œâ”€â”€ Embedding centroid por tenant/intent
â”œâ”€â”€ Embedding variance
â”œâ”€â”€ Classification confidence distribution
â”œâ”€â”€ Satisfaction rate (from RLHF)
â”œâ”€â”€ Error rate
â”œâ”€â”€ Response time distribution
â””â”€â”€ Intent distribution
```

### 3.2 Statistical Tests (2 semanas)

```
Objetivo: Implementar tests estadÃ­sticos para detectar drift

Entregables:
â”œâ”€â”€ Kolmogorov-Smirnov test
â”œâ”€â”€ Chi-Square test para distribuciones categÃ³ricas
â”œâ”€â”€ Population Stability Index (PSI)
â”œâ”€â”€ CUSUM (Cumulative Sum) detector
â””â”€â”€ Reference distribution manager

Tests implementados:
â”œâ”€â”€ KS Test: Comparar distribuciones continuas
â”œâ”€â”€ Chi-Square: Comparar distribuciones categÃ³ricas
â”œâ”€â”€ PSI: Medir estabilidad de poblaciÃ³n
â”œâ”€â”€ CUSUM: Detectar cambios graduales
â””â”€â”€ Page-Hinkley: Detectar cambios abruptos
```

### 3.3 Alerting System (1.5 semanas)

```
Objetivo: Sistema de alertas para notificar drift detectado

Entregables:
â”œâ”€â”€ AlertingService
â”œâ”€â”€ Slack integration
â”œâ”€â”€ Email notifications
â”œâ”€â”€ Dashboard widgets
â””â”€â”€ Alert configuration per tenant

Niveles de alerta:
â”œâ”€â”€ INFO: Drift menor detectado, monitorear
â”œâ”€â”€ WARNING: Drift significativo, revisar
â”œâ”€â”€ CRITICAL: Drift severo, acciÃ³n requerida
â””â”€â”€ EMERGENCY: Sistema degradado, intervenciÃ³n inmediata
```

### 3.4 Dashboard & Monitoring (1.5 semanas)

```
Objetivo: VisualizaciÃ³n de mÃ©tricas y drift

Entregables:
â”œâ”€â”€ Drift monitoring dashboard
â”œâ”€â”€ Historical charts
â”œâ”€â”€ Tenant comparison view
â”œâ”€â”€ Export functionality
â””â”€â”€ API endpoints para dashboard

Visualizaciones:
â”œâ”€â”€ Drift score over time
â”œâ”€â”€ Embedding space visualization
â”œâ”€â”€ Performance metrics trend
â”œâ”€â”€ Alert history
â””â”€â”€ Comparison: baseline vs current
```

---

## ğŸ’» ImplementaciÃ³n de Alto Nivel

### Schema de Base de Datos

```sql
-- MÃ©tricas de drift
CREATE TABLE ai_drift_metrics (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  tenant_id UUID NOT NULL REFERENCES tenants(id),

  -- Time window
  window_start TIMESTAMPTZ NOT NULL,
  window_end TIMESTAMPTZ NOT NULL,
  window_type TEXT NOT NULL, -- '1h', '24h', '7d'

  -- Embedding metrics
  embedding_centroid VECTOR(1536),
  embedding_variance FLOAT,
  embedding_samples INT,

  -- Classification metrics
  intent_distribution JSONB, -- {intent: count}
  avg_confidence FLOAT,
  confidence_variance FLOAT,

  -- Performance metrics
  satisfaction_rate FLOAT,
  error_rate FLOAT,
  avg_response_time_ms FLOAT,

  -- Computed at insert
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Reference distributions (baselines)
CREATE TABLE ai_drift_references (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  tenant_id UUID NOT NULL REFERENCES tenants(id),

  -- Reference period
  reference_start TIMESTAMPTZ NOT NULL,
  reference_end TIMESTAMPTZ NOT NULL,

  -- Baseline metrics
  embedding_centroid VECTOR(1536),
  embedding_variance FLOAT,
  intent_distribution JSONB,
  avg_confidence FLOAT,
  satisfaction_rate FLOAT,

  -- Status
  is_active BOOLEAN DEFAULT TRUE,
  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Drift detection results
CREATE TABLE ai_drift_detections (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  tenant_id UUID NOT NULL REFERENCES tenants(id),

  -- Detection details
  drift_type TEXT NOT NULL, -- 'data', 'concept', 'performance'
  severity TEXT NOT NULL, -- 'low', 'medium', 'high', 'critical'
  confidence FLOAT NOT NULL,

  -- Test results
  test_name TEXT NOT NULL, -- 'ks_test', 'chi_square', 'psi'
  test_statistic FLOAT NOT NULL,
  p_value FLOAT,
  threshold FLOAT NOT NULL,

  -- Context
  metric_name TEXT NOT NULL,
  current_value FLOAT,
  reference_value FLOAT,
  delta_percentage FLOAT,

  -- Status
  acknowledged BOOLEAN DEFAULT FALSE,
  resolved BOOLEAN DEFAULT FALSE,
  resolved_at TIMESTAMPTZ,
  resolution_notes TEXT,

  created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Indexes
CREATE INDEX idx_drift_metrics_tenant_window ON ai_drift_metrics(tenant_id, window_end DESC);
CREATE INDEX idx_drift_references_active ON ai_drift_references(tenant_id, is_active);
CREATE INDEX idx_drift_detections_unresolved ON ai_drift_detections(tenant_id, resolved, created_at DESC);
```

### Drift Detector Service (PseudocÃ³digo)

```typescript
// src/features/ai/drift/services/drift-detector.service.ts

interface DriftDetectionResult {
  tenant_id: string;
  drift_type: 'data' | 'concept' | 'performance';
  severity: 'low' | 'medium' | 'high' | 'critical';
  test_results: TestResult[];
  recommendation: string;
}

class DriftDetectorService {
  async detectDrift(tenantId: string): Promise<DriftDetectionResult | null> {
    // 1. Get reference distribution
    const reference = await this.getActiveReference(tenantId);
    if (!reference) return null;

    // 2. Get current metrics
    const current = await this.getCurrentMetrics(tenantId, '24h');

    // 3. Run statistical tests
    const testResults: TestResult[] = [];

    // Data drift: KS test on embedding distributions
    const ksResult = await this.runKSTest(
      reference.embedding_samples,
      current.embedding_samples
    );
    testResults.push(ksResult);

    // Concept drift: Chi-square on intent distribution
    const chiResult = await this.runChiSquareTest(
      reference.intent_distribution,
      current.intent_distribution
    );
    testResults.push(chiResult);

    // Performance drift: Compare satisfaction rates
    const psiResult = await this.runPSI(
      reference.satisfaction_rate,
      current.satisfaction_rate
    );
    testResults.push(psiResult);

    // 4. Aggregate results
    const driftDetected = testResults.some(r => r.drift_detected);

    if (!driftDetected) return null;

    // 5. Determine severity
    const severity = this.calculateSeverity(testResults);

    // 6. Generate recommendation
    const recommendation = this.generateRecommendation(testResults);

    return {
      tenant_id: tenantId,
      drift_type: this.determineDriftType(testResults),
      severity,
      test_results: testResults,
      recommendation,
    };
  }

  private calculateSeverity(results: TestResult[]): string {
    const maxScore = Math.max(...results.map(r => r.drift_score));

    if (maxScore > 0.5) return 'critical';
    if (maxScore > 0.3) return 'high';
    if (maxScore > 0.15) return 'medium';
    return 'low';
  }
}
```

---

## ğŸ”” Alertas y Monitoreo

### ConfiguraciÃ³n de Alertas

```typescript
// Alert thresholds configuration
const ALERT_CONFIG = {
  data_drift: {
    ks_statistic: {
      warning: 0.1,
      critical: 0.2,
    },
    psi: {
      warning: 0.1,
      critical: 0.25,
    },
  },
  concept_drift: {
    chi_square_p_value: {
      warning: 0.05,
      critical: 0.01,
    },
    intent_distribution_change: {
      warning: 0.15,
      critical: 0.30,
    },
  },
  performance_drift: {
    satisfaction_drop: {
      warning: 0.05,
      critical: 0.10,
    },
    error_rate_increase: {
      warning: 0.02,
      critical: 0.05,
    },
  },
};
```

### Dashboard Metrics

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DRIFT MONITORING DASHBOARD                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Overall Health Score: 87/100 ğŸŸ¢                                â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Data Drift (KS)        â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â”‚ 0.08 (OK)       â”‚   â”‚
â”‚  â”‚  Concept Drift (ChiÂ²)   â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â”‚ 0.12 (Warning)  â”‚   â”‚
â”‚  â”‚  Performance Drift      â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚ 0.05 (OK)       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  Recent Alerts (7 days):                                        â”‚
â”‚  â”œâ”€â”€ [WARN] 2026-01-22: Intent distribution shift detected     â”‚
â”‚  â”œâ”€â”€ [INFO] 2026-01-20: Minor embedding variance increase      â”‚
â”‚  â””â”€â”€ [OK] 2026-01-18: All metrics within normal range          â”‚
â”‚                                                                  â”‚
â”‚  Trend (30 days):                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚     â•±â•²                                                   â”‚   â”‚
â”‚  â”‚    â•±  â•²    â•±â•²                                           â”‚   â”‚
â”‚  â”‚   â•±    â•²â•±â•±  â•²                                           â”‚   â”‚
â”‚  â”‚  â•±           â•²___                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… Checklist General

```
â–¡ FASE 3.1: Metrics Collector
â”œâ”€â”€ [ ] DiseÃ±ar schema de mÃ©tricas
â”œâ”€â”€ [ ] Implementar collector service
â”œâ”€â”€ [ ] Integrar con embedding service
â”œâ”€â”€ [ ] Integrar con RLHF
â”œâ”€â”€ [ ] Cron job para recolecciÃ³n
â””â”€â”€ [ ] Unit tests

â–¡ FASE 3.2: Statistical Tests
â”œâ”€â”€ [ ] Implementar KS test
â”œâ”€â”€ [ ] Implementar Chi-square
â”œâ”€â”€ [ ] Implementar PSI
â”œâ”€â”€ [ ] Reference manager
â”œâ”€â”€ [ ] Drift detector service
â””â”€â”€ [ ] Validation tests

â–¡ FASE 3.3: Alerting
â”œâ”€â”€ [ ] Alert service
â”œâ”€â”€ [ ] Slack integration
â”œâ”€â”€ [ ] Email notifications
â”œâ”€â”€ [ ] Alert configuration UI
â””â”€â”€ [ ] Integration tests

â–¡ FASE 3.4: Dashboard
â”œâ”€â”€ [ ] API endpoints
â”œâ”€â”€ [ ] Dashboard components
â”œâ”€â”€ [ ] Historical views
â”œâ”€â”€ [ ] Export functionality
â””â”€â”€ [ ] E2E tests
```

---

## ğŸ“š Documentos Detallados

- [3.1-METRICS-COLLECTOR.md](./3.1-METRICS-COLLECTOR.md) ğŸ“ Pendiente
- [3.2-STATISTICAL-TESTS.md](./3.2-STATISTICAL-TESTS.md) ğŸ“ Pendiente
- [3.3-ALERTING.md](./3.3-ALERTING.md) ğŸ“ Pendiente
- [3.4-DASHBOARD.md](./3.4-DASHBOARD.md) ğŸ“ Pendiente

---

**Siguiente fase:** [FASE-4-FEATURE-STORE/4.0-OVERVIEW.md](../FASE-4-FEATURE-STORE/4.0-OVERVIEW.md)
